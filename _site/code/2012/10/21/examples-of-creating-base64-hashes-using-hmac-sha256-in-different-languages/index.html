<!DOCTYPE html>
<html lang="en-us">
  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Examples of creating base64 hashes using HMAC SHA256 in different languages &middot; Joe Kampschmidt
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,400,600,700' rel='stylesheet' type='text/css'>

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>

  <body>
    <div class="masthead">
      <div class="container center">

      <h3 class="masthead-title">
        <a href="/" title="also known as @jokecamp">Joe Kampschmidt</a>
      </h3>
      <div class="center"><small>Joe's Code - a pragmatic approach to web and software development</small></div>

      <nav class="nav">
        <a class="" href="/">Home</a>
        
        
          
            
          
        
          
        
          
            
          
        
          
            
              <a class="" href="/posts/" title="Blog Posts">Blog Posts</a>
            
          
        
          
            
              <a class="" href="/projects/" title="Projects">Projects</a>
            
          
        
          
        
        <a href="https://github.com/jokecamp" title="Joe's github page - commit all the things">GitHub</a>
        <a href="http://stackoverflow.com/users/215502/kampsj" title="Joe's stackoverflow account - aka street credit">StackOverflow</a>
        <a href="https://twitter.com/jokecamp" title="Joe's twitter account">Twitter</a>
      </div>
      </nav>
    </div>
    <div class="container content">
      <div class="post">
  <h1 class="post-title">Examples of creating base64 hashes using HMAC SHA256 in different languages</h1>
  <span class="post-date">21 Oct 2012</span>
  <p>I recently went through the processing of creating SDKs for an in house API. The API required signing every REST request with HMAC SHA256 signatures. Those signatures then needed to be converted to base64. Amazon S3 uses base64 strings for their hashes. There are some good reasons to use base64 encoding. See <a href="http://stackoverflow.com/a/201510/215502">What is the use of base 64 encoding?</a> on stackoverflow.</p>

<p>Below are some simplified HMAC SHA 256 solutions. They should all output &quot;<strong>qnR8UCqJggD55PohusaBNviGoOJ67HC6Btry4qXLVZc=</strong>&quot; given the values of &quot;<strong>secret</strong>&quot; and &quot;<strong>Message</strong>&quot; Take notice of the capital M. It is case sensitive.</p>

<p>Jump to an implementation:</p>

<ul>
<li><a href="#js">Javascript</a></li>
<li><a href="#php">PHP</a></li>
<li><a href="#java">Java</a></li>
<li><a href="#groovy">Groovy</a></li>
<li><a href="#csharp">C#</a></li>
<li><a href="#objc">Objective C</a></li>
<li><a href="#go">Go</a></li>
<li><a href="#ruby">Ruby</a></li>
<li><a href="#python">Python</a></li>
<li><a href="#perl">Perl</a></li>
<li><a href="#dart">Dart</a></li>
</ul>

<h3><a name='js'></a>Javascript HMAC SHA256</h3>

<p>A simple js library to use is crypto. <a href="http://code.google.com/p/crypto-js/">http://code.google.com/p/crypto-js/</a></p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="o">&lt;</span><span class="nx">script</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;text/javascript&quot;</span>
  <span class="nx">src</span><span class="o">=</span><span class="s2">&quot;http://crypto-js.googlecode.com/svn/tags/3.0.2/build/rollups/hmac-sha256.js&quot;</span><span class="o">&gt;&lt;</span><span class="err">/script&gt;</span>
<span class="o">&lt;</span><span class="nx">script</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;text/javascript&quot;</span>
  <span class="nx">src</span><span class="o">=</span><span class="s2">&quot;http://crypto-js.googlecode.com/svn/tags/3.0.2/build/components/enc-base64-min.js&quot;</span><span class="o">&gt;&lt;</span><span class="err">/script&gt;</span>
<span class="o">&lt;</span><span class="nx">script</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;text/javascript&quot;</span><span class="o">&gt;</span><span class="c1">// &lt;![CDATA[</span>
 <span class="kd">var</span> <span class="nx">hash</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacSHA256</span><span class="p">(</span><span class="s2">&quot;Message&quot;</span><span class="p">,</span> <span class="s2">&quot;secret&quot;</span><span class="p">);</span>
 <span class="kd">var</span> <span class="nx">hashInBase64</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">enc</span><span class="p">.</span><span class="nx">Base64</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">hash</span><span class="p">);</span>
 <span class="nb">document</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="nx">hashInBase64</span><span class="p">);</span>
<span class="c1">// ]]&gt;&lt;/script&gt;</span>
</code></pre></div>
<h3><a name='php'></a>PHP HMAC SHA256</h3>
<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="x">$s = hash_hmac(&#39;sha256&#39;, &#39;Message&#39;, &#39;secret&#39;, true);</span>
<span class="x">echo base64_encode($s);</span>
</code></pre></div>
<h3><a name='java'></a>Java HMAC SHA256</h3>

<p>Dependent on <a href="http://commons.apache.org/codec/">Apache Commons Codec</a> to encode in base64.</p>
<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">import</span> <span class="nn">javax.crypto.Mac</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.crypto.spec.SecretKeySpec</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.commons.codec.binary.Base64</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ApiSecurityExample</span> <span class="o">{</span>

<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>

<span class="k">try</span> <span class="o">{</span>
 <span class="n">String</span> <span class="n">secret</span> <span class="o">=</span> <span class="s">&quot;secret&quot;</span><span class="o">;</span>
 <span class="n">String</span> <span class="n">message</span> <span class="o">=</span> <span class="s">&quot;Message&quot;</span><span class="o">;</span>

 <span class="n">Mac</span> <span class="n">sha256_HMAC</span> <span class="o">=</span> <span class="n">Mac</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">&quot;HmacSHA256&quot;</span><span class="o">);</span>
 <span class="n">SecretKeySpec</span> <span class="n">secret_key</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SecretKeySpec</span><span class="o">(</span><span class="n">secret</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(),</span> <span class="s">&quot;HmacSHA256&quot;</span><span class="o">);</span>
 <span class="n">sha256_HMAC</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="n">secret_key</span><span class="o">);</span>

<span class="n">String</span> <span class="n">hash</span> <span class="o">=</span> <span class="n">Base64</span><span class="o">.</span><span class="na">encodeBase64String</span><span class="o">(</span><span class="n">sha256_HMAC</span><span class="o">.</span><span class="na">doFinal</span><span class="o">(</span><span class="n">message</span><span class="o">.</span><span class="na">getBytes</span><span class="o">()));</span>
 <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">hash</span><span class="o">);</span>
 <span class="o">}</span>
 <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">){</span>
 <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Error&quot;</span><span class="o">);</span>
 <span class="o">}</span>
 <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>
<h3><a name='groovy'></a>Groovy HMAC SHA256</h3>

<p>It is mostly java code but there are some slight differences. Taken and adapter from <a href="http://juliusgithaiga.blogspot.com/2013/06/hmacsha256-representation.html">Dev Takeout - Groovy HMAC/SHA256 representation</a> blog post.</p>
<div class="highlight"><pre><code class="language-groovy" data-lang="groovy"><span class="kn">import</span> <span class="nn">javax.crypto.Mac</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.crypto.spec.SecretKeySpec</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.security.InvalidKeyException</span><span class="o">;</span>

<span class="kt">def</span> <span class="nf">hmac_sha256</span><span class="o">(</span><span class="n">String</span> <span class="n">secretKey</span><span class="o">,</span> <span class="n">String</span> <span class="n">data</span><span class="o">)</span> <span class="o">{</span>
 <span class="k">try</span> <span class="o">{</span>
    <span class="n">Mac</span> <span class="n">mac</span> <span class="o">=</span> <span class="n">Mac</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s2">&quot;HmacSHA256&quot;</span><span class="o">)</span>
    <span class="n">SecretKeySpec</span> <span class="n">secretKeySpec</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SecretKeySpec</span><span class="o">(</span><span class="n">secretKey</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(),</span> <span class="s2">&quot;HmacSHA256&quot;</span><span class="o">)</span>
    <span class="n">mac</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="n">secretKeySpec</span><span class="o">)</span>
    <span class="kt">byte</span><span class="o">[]</span> <span class="n">digest</span> <span class="o">=</span> <span class="n">mac</span><span class="o">.</span><span class="na">doFinal</span><span class="o">(</span><span class="n">data</span><span class="o">.</span><span class="na">getBytes</span><span class="o">())</span>
    <span class="k">return</span> <span class="n">digest</span>
   <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">InvalidKeyException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="s2">&quot;Invalid key exception while converting to HMac SHA256&quot;</span><span class="o">)</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="kt">def</span> <span class="n">hash</span> <span class="o">=</span> <span class="n">hmac_sha256</span><span class="o">(</span><span class="s2">&quot;secret&quot;</span><span class="o">,</span> <span class="s2">&quot;Message&quot;</span><span class="o">)</span>
<span class="n">encodedData</span> <span class="o">=</span> <span class="n">hash</span><span class="o">.</span><span class="na">encodeBase64</span><span class="o">().</span><span class="na">toString</span><span class="o">()</span>
<span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="n">encodedData</span><span class="o">)</span>
</code></pre></div>
<h3><a name='csharp'></a>C# HMAC SHA256</h3>
<div class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="k">using</span> <span class="nn">System.Security.Cryptography</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">Test</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">MyHmac</span>
    <span class="p">{</span>
        <span class="k">private</span> <span class="kt">string</span> <span class="nf">CreateToken</span><span class="p">(</span><span class="kt">string</span> <span class="n">message</span><span class="p">,</span> <span class="kt">string</span> <span class="n">secret</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">secret</span> <span class="p">=</span> <span class="n">secret</span> <span class="p">??</span> <span class="s">&quot;&quot;</span><span class="p">;</span>
            <span class="kt">var</span> <span class="n">encoding</span> <span class="p">=</span> <span class="k">new</span> <span class="n">System</span><span class="p">.</span><span class="n">Text</span><span class="p">.</span><span class="n">ASCIIEncoding</span><span class="p">();</span>
            <span class="kt">byte</span><span class="p">[]</span> <span class="n">keyByte</span> <span class="p">=</span> <span class="n">encoding</span><span class="p">.</span><span class="n">GetBytes</span><span class="p">(</span><span class="n">secret</span><span class="p">);</span>
            <span class="kt">byte</span><span class="p">[]</span> <span class="n">messageBytes</span> <span class="p">=</span> <span class="n">encoding</span><span class="p">.</span><span class="n">GetBytes</span><span class="p">(</span><span class="n">message</span><span class="p">);</span>
            <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">hmacsha256</span> <span class="p">=</span> <span class="k">new</span> <span class="n">HMACSHA256</span><span class="p">(</span><span class="n">keyByte</span><span class="p">))</span>
            <span class="p">{</span>
                <span class="kt">byte</span><span class="p">[]</span> <span class="n">hashmessage</span> <span class="p">=</span> <span class="n">hmacsha256</span><span class="p">.</span><span class="n">ComputeHash</span><span class="p">(</span><span class="n">messageBytes</span><span class="p">);</span>
                <span class="k">return</span> <span class="n">Convert</span><span class="p">.</span><span class="n">ToBase64String</span><span class="p">(</span><span class="n">hashmessage</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h3><a name='objc'></a>Objective C and Cocoa HMAC SHA256</h3>

<p>Most of the code required was for converting to bae64 and working the NSString and NSData data types.</p>
<div class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="cp">#import &quot;AppDelegate.h&quot;</span>
<span class="cp">#import &lt;CommonCrypto/CommonHMAC.h&gt;</span>

<span class="k">@implementation</span> <span class="nc">AppDelegate</span>

<span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">applicationDidFinishLaunching:</span><span class="p">(</span><span class="n">NSNotification</span> <span class="o">*</span><span class="p">)</span><span class="nv">aNotification</span> <span class="p">{</span>
 <span class="n">NSString</span><span class="o">*</span> <span class="n">key</span> <span class="o">=</span> <span class="s">@&quot;secret&quot;</span><span class="p">;</span>
 <span class="n">NSString</span><span class="o">*</span> <span class="n">data</span> <span class="o">=</span> <span class="s">@&quot;Message&quot;</span><span class="p">;</span>

 <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">cKey</span> <span class="o">=</span> <span class="p">[</span><span class="n">key</span> <span class="n">cStringUsingEncoding</span><span class="o">:</span><span class="n">NSASCIIStringEncoding</span><span class="p">];</span>
 <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">cData</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span> <span class="n">cStringUsingEncoding</span><span class="o">:</span><span class="n">NSASCIIStringEncoding</span><span class="p">];</span>
 <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">cHMAC</span><span class="p">[</span><span class="n">CC_SHA256_DIGEST_LENGTH</span><span class="p">];</span>
 <span class="n">CCHmac</span><span class="p">(</span><span class="n">kCCHmacAlgSHA256</span><span class="p">,</span> <span class="n">cKey</span><span class="p">,</span> <span class="n">strlen</span><span class="p">(</span><span class="n">cKey</span><span class="p">),</span> <span class="n">cData</span><span class="p">,</span> <span class="n">strlen</span><span class="p">(</span><span class="n">cData</span><span class="p">),</span> <span class="n">cHMAC</span><span class="p">);</span>
 <span class="n">NSData</span> <span class="o">*</span><span class="n">hash</span> <span class="o">=</span> <span class="p">[[</span><span class="n">NSData</span> <span class="n">alloc</span><span class="p">]</span> <span class="n">initWithBytes</span><span class="o">:</span><span class="n">cHMAC</span> <span class="n">length</span><span class="o">:</span><span class="k">sizeof</span><span class="p">(</span><span class="n">cHMAC</span><span class="p">)];</span>

 <span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;%@&quot;</span><span class="p">,</span> <span class="n">hash</span><span class="p">);</span>

 <span class="n">NSString</span><span class="o">*</span> <span class="n">s</span> <span class="o">=</span> <span class="p">[</span><span class="n">AppDelegate</span> <span class="n">base64forData</span><span class="o">:</span><span class="n">hash</span><span class="p">];</span>
 <span class="n">NSLog</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">+</span> <span class="p">(</span><span class="n">NSString</span><span class="o">*</span><span class="p">)</span><span class="nf">base64forData:</span><span class="p">(</span><span class="n">NSData</span><span class="o">*</span><span class="p">)</span><span class="nv">theData</span> <span class="p">{</span>
 <span class="k">const</span> <span class="kt">uint8_t</span><span class="o">*</span> <span class="n">input</span> <span class="o">=</span> <span class="p">(</span><span class="k">const</span> <span class="kt">uint8_t</span><span class="o">*</span><span class="p">)[</span><span class="n">theData</span> <span class="n">bytes</span><span class="p">];</span>
 <span class="n">NSInteger</span> <span class="n">length</span> <span class="o">=</span> <span class="p">[</span><span class="n">theData</span> <span class="n">length</span><span class="p">];</span>

 <span class="k">static</span> <span class="kt">char</span> <span class="n">table</span><span class="p">[]</span> <span class="o">=</span> <span class="s">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&quot;</span><span class="p">;</span>

 <span class="n">NSMutableData</span><span class="o">*</span> <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSMutableData</span> <span class="n">dataWithLength</span><span class="o">:</span><span class="p">((</span><span class="n">length</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="mi">4</span><span class="p">];</span>
 <span class="kt">uint8_t</span><span class="o">*</span> <span class="n">output</span> <span class="o">=</span> <span class="p">(</span><span class="kt">uint8_t</span><span class="o">*</span><span class="p">)</span><span class="n">data</span><span class="p">.</span><span class="n">mutableBytes</span><span class="p">;</span>

 <span class="n">NSInteger</span> <span class="n">i</span><span class="p">;</span>
 <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">length</span><span class="p">;</span> <span class="n">i</span> <span class="o">+=</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
 <span class="n">NSInteger</span> <span class="n">value</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
 <span class="n">NSInteger</span> <span class="n">j</span><span class="p">;</span>
 <span class="k">for</span> <span class="p">(</span><span class="n">j</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">);</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
 <span class="n">value</span> <span class="o">&lt;&lt;=</span> <span class="mi">8</span><span class="p">;</span>

 <span class="k">if</span> <span class="p">(</span><span class="n">j</span> <span class="o">&lt;</span> <span class="n">length</span><span class="p">)</span> <span class="p">{</span>  <span class="n">value</span> <span class="o">|=</span> <span class="p">(</span><span class="mh">0xFF</span> <span class="o">&amp;</span> <span class="n">input</span><span class="p">[</span><span class="n">j</span><span class="p">]);</span>  <span class="p">}</span>  <span class="p">}</span>  <span class="n">NSInteger</span> <span class="n">theIndex</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="mi">4</span><span class="p">;</span>  <span class="n">output</span><span class="p">[</span><span class="n">theIndex</span> <span class="o">+</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">table</span><span class="p">[(</span><span class="n">value</span> <span class="o">&gt;&gt;</span> <span class="mi">18</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x3F</span><span class="p">];</span>
 <span class="n">output</span><span class="p">[</span><span class="n">theIndex</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">table</span><span class="p">[(</span><span class="n">value</span> <span class="o">&gt;&gt;</span> <span class="mi">12</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x3F</span><span class="p">];</span>
 <span class="n">output</span><span class="p">[</span><span class="n">theIndex</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">length</span> <span class="o">?</span> <span class="n">table</span><span class="p">[(</span><span class="n">value</span> <span class="o">&gt;&gt;</span> <span class="mi">6</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x3F</span><span class="p">]</span> <span class="o">:</span> <span class="sc">&#39;=&#39;</span><span class="p">;</span>
 <span class="n">output</span><span class="p">[</span><span class="n">theIndex</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">length</span> <span class="o">?</span> <span class="n">table</span><span class="p">[(</span><span class="n">value</span> <span class="o">&gt;&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x3F</span><span class="p">]</span> <span class="o">:</span> <span class="sc">&#39;=&#39;</span><span class="p">;</span>
 <span class="p">}</span>

 <span class="k">return</span> <span class="p">[[</span><span class="n">NSString</span> <span class="n">alloc</span><span class="p">]</span> <span class="n">initWithData</span><span class="o">:</span><span class="n">data</span> <span class="n">encoding</span><span class="o">:</span><span class="n">NSASCIIStringEncoding</span><span class="p">];</span> <span class="p">}</span>

<span class="k">@end</span>
</code></pre></div>
<h3><a name='go'></a>Go programming language - Golang HMAC SHA256</h3>

<ul>
<li><a href="http://play.golang.org/p/05CGjt778r">Try it online in your browser with Play GoLang</a></li>
<li><a href="http://golang.org/pkg/crypto/hmac/">crypto/hmac package</a></li>
</ul>
<div class="highlight"><pre><code class="language-go" data-lang="go"><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
    <span class="s">&quot;crypto/hmac&quot;</span>
    <span class="s">&quot;crypto/sha256&quot;</span>
    <span class="s">&quot;encoding/base64&quot;</span>
    <span class="s">&quot;fmt&quot;</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nx">ComputeHmac256</span><span class="p">(</span><span class="nx">message</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">secret</span> <span class="kt">string</span><span class="p">)</span> <span class="kt">string</span> <span class="p">{</span>
    <span class="nx">key</span> <span class="o">:=</span> <span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="nx">secret</span><span class="p">)</span>
    <span class="nx">h</span> <span class="o">:=</span> <span class="nx">hmac</span><span class="p">.</span><span class="nx">New</span><span class="p">(</span><span class="nx">sha256</span><span class="p">.</span><span class="nx">New</span><span class="p">,</span> <span class="nx">key</span><span class="p">)</span>
    <span class="nx">h</span><span class="p">.</span><span class="nx">Write</span><span class="p">([]</span><span class="nb">byte</span><span class="p">(</span><span class="nx">message</span><span class="p">))</span>
    <span class="k">return</span> <span class="nx">base64</span><span class="p">.</span><span class="nx">StdEncoding</span><span class="p">.</span><span class="nx">EncodeToString</span><span class="p">(</span><span class="nx">h</span><span class="p">.</span><span class="nx">Sum</span><span class="p">(</span><span class="kc">nil</span><span class="p">))</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">ComputeHmac256</span><span class="p">(</span><span class="s">&quot;Message&quot;</span><span class="p">,</span> <span class="s">&quot;secret&quot;</span><span class="p">))</span>
<span class="p">}</span>
</code></pre></div>
<h3><a name='ruby'></a>Ruby HMAC SHA256</h3>

<p>Requires <a href="http://www.ruby-doc.org/stdlib-1.9.3/libdoc/openssl/rdoc/OpenSSL.html">openssl</a> and <a href="http://ruby-doc.org/stdlib-2.0/libdoc/base64/rdoc/Base64.html">base64</a>.</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="nb">require</span> <span class="s1">&#39;openssl&#39;</span>
<span class="nb">require</span> <span class="s2">&quot;base64&quot;</span>

<span class="nb">hash</span>  <span class="o">=</span> <span class="no">OpenSSL</span><span class="o">::</span><span class="no">HMAC</span><span class="o">.</span><span class="n">digest</span><span class="p">(</span><span class="s1">&#39;sha256&#39;</span><span class="p">,</span> <span class="s2">&quot;secret&quot;</span><span class="p">,</span> <span class="s2">&quot;Message&quot;</span><span class="p">)</span>
<span class="nb">puts</span> <span class="no">Base64</span><span class="o">.</span><span class="n">encode64</span><span class="p">(</span><span class="nb">hash</span><span class="p">)</span>
</code></pre></div>
<h3><a name='python'></a>Python (2.7) HMAC SHA256</h3>
<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">base64</span>

<span class="n">message</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="s">&quot;Message&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">)</span>
<span class="n">secret</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="s">&quot;secret&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">)</span>

<span class="n">signature</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">hmac</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">secret</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">digestmod</span><span class="o">=</span><span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">)</span><span class="o">.</span><span class="n">digest</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="n">signature</span><span class="p">)</span>
</code></pre></div>
<p>Tested with Python 2.7.6. Also, be sure not to name your python demo script the same as one of the imported libraries.</p>

<h3><a name='perl'></a>Perl HMAC SHA256</h3>

<p>See <a href="http://search.cpan.org/%7Emshelor/Digest-SHA-5.85/lib/Digest/SHA.pm">Digest::SHA documentation</a>. By convention, the Digest modules do not pad their Base64 output. To fix this you can test the length of the hash and append equal signs &quot;=&quot; until it is the length is a multiple of 4. We will use a modulus function below.</p>
<div class="highlight"><pre><code class="language-perl" data-lang="perl"><span class="k">use</span> <span class="nn">Digest::</span><span class="n">SHA</span> <span class="sx">qw(hmac_sha256_base64)</span><span class="p">;</span>
<span class="nv">$digest</span> <span class="o">=</span> <span class="n">hmac_sha256_base64</span><span class="p">(</span><span class="s">&quot;Message&quot;</span><span class="p">,</span> <span class="s">&quot;secret&quot;</span><span class="p">);</span>

<span class="c1"># digest is currently: qnR8UCqJggD55PohusaBNviGoOJ67HC6Btry4qXLVZc</span>

<span class="c1"># Fix padding of Base64 digests</span>
<span class="k">while</span> <span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="nv">$digest</span><span class="p">)</span> <span class="nv">%</span> <span class="nv">4</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$digest</span> <span class="o">.=</span> <span class="s">&#39;=&#39;</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">print</span> <span class="nv">$digest</span><span class="p">;</span>
<span class="c1"># digest is now: qnR8UCqJggD55PohusaBNviGoOJ67HC6Btry4qXLVZc=</span>
</code></pre></div>
<h3><a name='dart'></a>Dart HMAC SHA256</h3>

<p>Dependent upon the Dart <a href="https://api.dartlang.org/docs/channels/stable/latest/crypto.html">crypto package</a>.</p>
<div class="highlight"><pre><code class="language-dart" data-lang="dart"><span class="k">import</span> <span class="s1">&#39;dart:html&#39;</span><span class="p">;</span>
<span class="k">import</span> <span class="s1">&#39;dart:convert&#39;</span><span class="p">;</span>
<span class="k">import</span> <span class="s1">&#39;package:crypto/crypto.dart&#39;</span><span class="p">;</span>

<span class="kt">void</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>

  <span class="kt">String</span> <span class="n">secret</span> <span class="o">=</span> <span class="s1">&#39;secret&#39;</span><span class="p">;</span>
  <span class="kt">String</span> <span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;Message&#39;</span><span class="p">;</span>

  <span class="n">List</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">secretBytes</span> <span class="o">=</span> <span class="n">UTF8</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;secret&#39;</span><span class="p">);</span>
  <span class="n">List</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">messageBytes</span> <span class="o">=</span> <span class="n">UTF8</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;Message&#39;</span><span class="p">);</span>

  <span class="kd">var</span> <span class="n">hmac</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HMAC</span><span class="p">(</span><span class="k">new</span> <span class="n">SHA256</span><span class="p">(),</span> <span class="n">secretBytes</span><span class="p">);</span>
  <span class="n">hmac</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">messageBytes</span><span class="p">);</span>
  <span class="kd">var</span> <span class="n">digest</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>

  <span class="kd">var</span> <span class="n">hash</span> <span class="o">=</span> <span class="n">CryptoUtils</span><span class="p">.</span><span class="n">bytesToBase64</span><span class="p">(</span><span class="n">digest</span><span class="p">);</span>

  <span class="c1">// output to html page</span>
  <span class="n">querySelector</span><span class="p">(</span><span class="s1">&#39;#hash&#39;</span><span class="p">).</span><span class="n">text</span> <span class="o">=</span> <span class="n">hash</span><span class="p">;</span>
  <span class="c1">// hash =&gt; qnR8UCqJggD55PohusaBNviGoOJ67HC6Btry4qXLVZc=</span>
<span class="p">}</span>
</code></pre></div>
</div>

<div class="related">
  <h2>Related Posts</h2>
  <ul class="related-posts">
    
      <li>
          <a href="//code/2014/06/28/alternate-way-to-build-your-own-football-db-sqlite-database/">
            Alternate way to build your own football.db sqlite database
            <small>28 Jun 2014</small>
          </a>
      </li>
    
      <li>
          <a href="//fun/2014/06/07/building-a-raspberry-pi-photo-frame/">
            Building a Raspberry Pi Photo Frame
            <small>07 Jun 2014</small>
          </a>
      </li>
    
      <li>
          <a href="//code/2014/06/06/resolving-angularjs-paths-in-asp-mvc-spa-iis/">
            Resolving AngularJS paths in a ASP.NET MVC SPA and IIS
            <small>06 Jun 2014</small>
          </a>
      </li>
    
  </ul>
</div>

      <div class="footer">
        <p><a href="/atom.xml" title="Atom Feed">Atom</a> | <a href="/rss.xml" title="RSS Feed">RSS</a></p>
        <p>Contact me at <a href="mailto:joe.kampschmidt@gmail.com" alt="email me">joe.kampschmdit@gmail.com</p>
      </div>
    </div>
  </body>
</html>
